from zeep import Client,Settings
from zeep.transports import Transport
from requests.auth import HTTPBasicAuth
from requests import Session
from bs4 import BeautifulSoup

###################################################################
#uploadFileToUcm(document: ns5:DocumentDetails)
#
#DocumentDetails(Content: ns6:base64Binary-DataHandler, 
#                FileName: xsd:string, 
#                ContentType: xsd:string, 
#                DocumentTitle: xsd:string, 
#                DocumentAuthor: xsd:string, 
#                DocumentSecurityGroup: xsd:string, 
#                DocumentAccount: xsd:string, 
#                DocumentName: xsd:string, 
#                DocumentId: xsd:string)
#
####################################################################

session = Session()
session.auth = HTTPBasicAuth("username","password")
transport = Transport(session=session)

settings=Settings(strict=False,xml_huge_tree=True)
client=Client('https://<hostname>.<domainname>/fscmService/ErpIntegrationService?wsdl',
              settings=settings,
              transport=transport)

document={"Content": b'UEsDBBQAAAAIALxdQk9e5+prPgAAAFMAAAAlAAAAR2xTZWdtZW50VmFsdWVzSW50ZXJmYWNlXzIwMTkxMDAyLmNzdoXBoQ3AIBBAUd+kO9wA38AIrSWoGmRJ0EeA7RCMxAqwAe/NPl4tWcvfkjh9MBbwBAi733EaxVj5Um2cyH0tUEsBAj8AFAAAAAgAvF1CT17n6ms+AAAAUwAAACUAJAAAAAAAAAAgAAAAAAAAAEdsU2VnbWVudFZhbHVlc0ludGVyZmFjZV8yMDE5MTAwMi5jc3YKACAAAAAAAAEAGAAxdi6Dy3jVATF2LoPLeNUBpJgYwMt01QFQSwUGAAAAAAEAAQB3AAAAgQAAAAAA',
          "FileName": "GlSegmentValuesInterface_20191002.zip",
          "ContentType": "zip",
          "DocumentTitle": "GlSegmentValuesInterface",
          "DocumentAuthor": "username",
          "DocumentSecurityGroup": "FAFusionImportExport",
          "DocumentAccount": "fin$/generalLedger$/import$"
          }

with client.settings(raw_response=True):
    response=client.service.uploadFileToUcm(document)
    if response.status_code == 200:
        respTxt=response.content.decode('utf-8')
        bs=BeautifulSoup(respTxt,"html.parser")
        print(bs.result.text)
    else:
        print("Access Error.")
    
